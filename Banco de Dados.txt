DROP DATABASE InstituicaoVestibular;

CREATE DATABASE IF NOT EXISTS InstituicaoVestibular;

USE InstituicaoVestibular;

-- Tabela para Usuários (Professores e Secretarias)
CREATE TABLE Usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE,
    senha VARCHAR(255) NOT NULL,
    tipo ENUM('Secretaria', 'Professor') NOT NULL,
    matricula VARCHAR(20) NOT NULL UNIQUE,
    cpf VARCHAR(11) NOT NULL UNIQUE,
    rg VARCHAR(20) NOT NULL UNIQUE,
    data_nascimento DATE,
    telefone VARCHAR(15)
);

-- Tabela para Alunos
CREATE TABLE Alunos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE,
    matricula VARCHAR(20) NOT NULL UNIQUE,
    cpf VARCHAR(11) NOT NULL UNIQUE,
    rg VARCHAR(20) NOT NULL UNIQUE,
    data_nascimento DATE,
    telefone VARCHAR(15)
);

-- Tabela para Cursos
CREATE TABLE Cursos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    descricao TEXT
);

-- Tabela para Disciplinas
CREATE TABLE Disciplinas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    curso_id INT,
    nome VARCHAR(100) NOT NULL,
    carga_horaria INT,
    FOREIGN KEY (curso_id) REFERENCES Cursos(id)
);

-- Tabela para Turmas
CREATE TABLE Turmas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    curso_id INT,
    nome VARCHAR(100) NOT NULL,
    ano INT NOT NULL,
    FOREIGN KEY (curso_id) REFERENCES Cursos(id)
);

-- Tabela para Professores em Turmas
CREATE TABLE Professores_Turmas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    turma_id INT,
    docente_id INT,
    FOREIGN KEY (turma_id) REFERENCES Turmas(id),
    FOREIGN KEY (docente_id) REFERENCES Usuarios(id)
);

-- Tabela para Disciplinas em Turmas
CREATE TABLE Disciplinas_Turmas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    turma_id INT,
    disciplina_id INT,
    FOREIGN KEY (turma_id) REFERENCES Turmas(id),
    FOREIGN KEY (disciplina_id) REFERENCES Disciplinas(id)
);

-- Tabela para Alunos em Turmas
CREATE TABLE Alunos_Turmas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    turma_id INT,
    aluno_id INT,
    FOREIGN KEY (turma_id) REFERENCES Turmas(id),
    FOREIGN KEY (aluno_id) REFERENCES Alunos(id)
);

-- Tabela para Aulas (Cronograma)
CREATE TABLE Aulas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    turma_id INT,
    data_aula DATE,
    tema VARCHAR(100),
    conteudo TEXT,
    FOREIGN KEY (turma_id) REFERENCES Turmas(id)
);

-- Tabela para Frequência
CREATE TABLE Frequencia (
    id INT AUTO_INCREMENT PRIMARY KEY,
    aluno_id INT,
    aula_id INT,
    status ENUM('Presente', 'Ausente') NOT NULL,
    FOREIGN KEY (aluno_id) REFERENCES Alunos(id),
    FOREIGN KEY (aula_id) REFERENCES Aulas(id)
);